# Changelog

## hardhat (development version)

- [`mold()`](https://hardhat.tidymodels.org/dev/reference/mold.md) no
  longer throws warnings about `strings_as_factors` argument when used
  on recipe objects
  ([\#284](https://github.com/tidymodels/hardhat/issues/284)).

## hardhat 1.4.2

CRAN release: 2025-08-20

- Added
  [`extract_tailor()`](https://hardhat.tidymodels.org/dev/reference/hardhat-extract.md)
  generic ([\#292](https://github.com/tidymodels/hardhat/issues/292)).

## hardhat 1.4.1

CRAN release: 2025-01-31

- Added a new vector class called
  [`quantile_pred()`](https://hardhat.tidymodels.org/dev/reference/quantile_pred.md)
  to house predictions made from a quantile regression model
  (tidymodels/parsnip#1191, [@dajmcdon](https://github.com/dajmcdon)).

- Several functions gained a `call` argument for passing the call used
  in errors and warnings
  ([\#275](https://github.com/tidymodels/hardhat/issues/275)).

- Errors and warnings are now generated with the cli package
  ([\#272](https://github.com/tidymodels/hardhat/issues/272)).

## hardhat 1.4.0

CRAN release: 2024-06-02

- Added
  [`extract_postprocessor()`](https://hardhat.tidymodels.org/dev/reference/hardhat-extract.md)
  generic ([\#247](https://github.com/tidymodels/hardhat/issues/247)).

- Added
  [`extract_fit_time()`](https://hardhat.tidymodels.org/dev/reference/hardhat-extract.md)
  generic ([\#218](https://github.com/tidymodels/hardhat/issues/218)).

## hardhat 1.3.1

CRAN release: 2024-02-02

- Changed an Rd name from `modeling-package` -\> `modeling-usethis` at
  the request of CRAN.

## hardhat 1.3.0

CRAN release: 2023-03-30

- New family of `spruce_*_multiple()` functions to support standardizing
  multi-outcome predictions
  ([\#223](https://github.com/tidymodels/hardhat/issues/223), with
  contributions from [@cregouby](https://github.com/cregouby)).

- New
  [`fct_encode_one_hot()`](https://hardhat.tidymodels.org/dev/reference/fct_encode_one_hot.md)
  that encodes a factor as a one-hot indicator matrix
  ([\#215](https://github.com/tidymodels/hardhat/issues/215)).

- [`default_recipe_blueprint()`](https://hardhat.tidymodels.org/dev/reference/default_recipe_blueprint.md)
  has gained a `strings_as_factors` argument, which is passed on to
  [`recipes::prep()`](https://recipes.tidymodels.org/reference/prep.html)
  ([\#212](https://github.com/tidymodels/hardhat/issues/212)).

- Using a formula blueprint with `indicators = "none"` and character
  predictors now works properly if you provide a character column that
  only contains a single value
  ([\#213](https://github.com/tidymodels/hardhat/issues/213)).

- Using a formula blueprint with `indicators = "traditional"` or
  `indicators = "one_hot"` and character predictors now properly
  enforces the factor levels generated by those predictors on `new_data`
  during
  [`forge()`](https://hardhat.tidymodels.org/dev/reference/forge.md)
  ([\#213](https://github.com/tidymodels/hardhat/issues/213)).

- Using a formula blueprint with `indicators = "none"` now works
  correctly if there is a variable in the formula with a space in the
  name ([\#217](https://github.com/tidymodels/hardhat/issues/217)).

- [`mold()`](https://hardhat.tidymodels.org/dev/reference/mold.md) and
  [`forge()`](https://hardhat.tidymodels.org/dev/reference/forge.md)
  generally have less overhead
  ([\#235](https://github.com/tidymodels/hardhat/issues/235),
  [\#236](https://github.com/tidymodels/hardhat/issues/236)).

- Added more documentation about importance and frequency weights in
  `?importance_weights()` and `?frequency_weights()`
  ([\#214](https://github.com/tidymodels/hardhat/issues/214)).

- New internal
  [`recompose()`](https://hardhat.tidymodels.org/dev/reference/recompose.md)
  helper ([\#220](https://github.com/tidymodels/hardhat/issues/220)).

## hardhat 1.2.0

CRAN release: 2022-06-30

- We have reverted the change made in hardhat 1.0.0 that caused recipe
  preprocessors to drop non-standard roles by default when calling
  [`forge()`](https://hardhat.tidymodels.org/dev/reference/forge.md).
  Determining what roles are required at
  [`bake()`](https://recipes.tidymodels.org/reference/bake.html) time is
  really something that should be controlled within recipes, not
  hardhat. This results in the following changes
  ([\#207](https://github.com/tidymodels/hardhat/issues/207)):

  - The new argument, `bake_dependent_roles`, that was added to
    [`default_recipe_blueprint()`](https://hardhat.tidymodels.org/dev/reference/default_recipe_blueprint.md)
    in 1.0.0 has been removed. It is no longer needed with the new
    behavior.

  - By default,
    [`forge()`](https://hardhat.tidymodels.org/dev/reference/forge.md)
    will pass on all columns from `new_data` to
    [`bake()`](https://recipes.tidymodels.org/reference/bake.html)
    except those with roles of `"outcome"` or `"case_weights"`. With
    `outcomes = TRUE`, it will also pass on the `"outcome"` role. This
    is essentially the same as the pre-1.0.0 behavior, and means that,
    by default, all non-standard roles are required at
    [`bake()`](https://recipes.tidymodels.org/reference/bake.html) time.
    This assumption is now also enforced by recipes 1.0.0, even if you
    aren’t using hardhat or a workflow.

  - In the development version of recipes, which will become recipes
    1.0.0, there is a new
    [`update_role_requirements()`](https://recipes.tidymodels.org/reference/update_role_requirements.html)
    function that can be used to declare that a role is not required at
    [`bake()`](https://recipes.tidymodels.org/reference/bake.html) time.
    hardhat now knows how to respect that feature, and in
    [`forge()`](https://hardhat.tidymodels.org/dev/reference/forge.md)
    it won’t pass on columns of `new_data` to
    [`bake()`](https://recipes.tidymodels.org/reference/bake.html) that
    have roles that aren’t required at
    [`bake()`](https://recipes.tidymodels.org/reference/bake.html) time.

## hardhat 1.1.0

CRAN release: 2022-06-10

- Fixed a bug where the results from calling
  [`mold()`](https://hardhat.tidymodels.org/dev/reference/mold.md) using
  hardhat \< 1.0.0 were no longer compatible with calling
  [`forge()`](https://hardhat.tidymodels.org/dev/reference/forge.md) in
  hardhat \>= 1.0.0. This could occur if you save a workflow object
  after fitting it, then load it into an R session that uses a newer
  version of hardhat
  ([\#200](https://github.com/tidymodels/hardhat/issues/200)).

- Internal details related to how blueprints work alongside
  [`mold()`](https://hardhat.tidymodels.org/dev/reference/mold.md) and
  [`forge()`](https://hardhat.tidymodels.org/dev/reference/forge.md)
  were heavily re-factored to support the fix for
  [\#200](https://github.com/tidymodels/hardhat/issues/200). These
  changes are mostly internal or developer focused. They include:

  - Blueprints no longer store the clean/process functions used when
    calling
    [`mold()`](https://hardhat.tidymodels.org/dev/reference/mold.md) and
    [`forge()`](https://hardhat.tidymodels.org/dev/reference/forge.md).
    These were stored in `blueprint$mold$clean()`,
    `blueprint$mold$process()`, `blueprint$forge$clean()`, and
    `blueprint$forge$process()` and were strictly for internal use.
    Storing them in the blueprint caused problems because blueprints
    created with old versions of hardhat were unlikely to be compatible
    with newer versions of hardhat. This change means that
    [`new_blueprint()`](https://hardhat.tidymodels.org/dev/reference/new-blueprint.md)
    and the other blueprint constructors no longer have `mold` or
    `forge` arguments.

  - [`run_mold()`](https://hardhat.tidymodels.org/dev/reference/run-mold.md)
    has been repurposed. Rather than calling the `$clean()` and
    `$process()` functions (which, as mentioned above, are no longer in
    the blueprint), the methods for this S3 generic have been rewritten
    to directly call the current versions of the clean and process
    functions that live in hardhat. This should result in less
    accidental breaking changes.

  - New
    [`run_forge()`](https://hardhat.tidymodels.org/dev/reference/run-forge.md)
    which is a
    [`forge()`](https://hardhat.tidymodels.org/dev/reference/forge.md)
    equivalent to
    [`run_mold()`](https://hardhat.tidymodels.org/dev/reference/run-mold.md).
    It handles the clean/process steps that were previously handled by
    the `$clean()` and `$process()` functions stored directly in the
    blueprint.

## hardhat 1.0.0

CRAN release: 2022-06-01

- Recipe preprocessors now ignore non-standard recipe roles (i.e. not
  `"outcome"` or `"predictor"`) by default when calling
  [`forge()`](https://hardhat.tidymodels.org/dev/reference/forge.md).
  Previously, it was assumed that all non-standard role columns present
  in the original training data were also required in the test data when
  [`forge()`](https://hardhat.tidymodels.org/dev/reference/forge.md) is
  called. It seems to be more often the case that those columns are
  actually not required to
  [`bake()`](https://recipes.tidymodels.org/reference/bake.html) new
  data, and often won’t even be present when making predictions on new
  data. For example, a custom `"case_weights"` role might be required
  for computing case-weighted estimates at
  [`prep()`](https://recipes.tidymodels.org/reference/prep.html) time,
  but won’t be necessary at
  [`bake()`](https://recipes.tidymodels.org/reference/bake.html) time
  (since the estimates have already been pre-computed and stored). To
  account for the case when you do require a specific non-standard role
  to be present at
  [`bake()`](https://recipes.tidymodels.org/reference/bake.html) time,
  [`default_recipe_blueprint()`](https://hardhat.tidymodels.org/dev/reference/default_recipe_blueprint.md)
  has gained a new argument, `bake_dependent_roles`, which can be set to
  a character vector of non-standard roles that are required.

- New
  [`weighted_table()`](https://hardhat.tidymodels.org/dev/reference/weighted_table.md)
  for generating a weighted contingency table, similar to
  [`table()`](https://rdrr.io/r/base/table.html)
  ([\#191](https://github.com/tidymodels/hardhat/issues/191)).

- New experimental family of functions for working with case weights. In
  particular,
  [`frequency_weights()`](https://hardhat.tidymodels.org/dev/reference/frequency_weights.md)
  and
  [`importance_weights()`](https://hardhat.tidymodels.org/dev/reference/importance_weights.md)
  ([\#190](https://github.com/tidymodels/hardhat/issues/190)).

- [`use_modeling_files()`](https://hardhat.tidymodels.org/dev/reference/modeling-usethis.md)
  and
  [`create_modeling_package()`](https://hardhat.tidymodels.org/dev/reference/modeling-usethis.md)
  no longer open the package documentation file in the current RStudio
  session ([\#192](https://github.com/tidymodels/hardhat/issues/192)).

- rlang \>=1.0.2 and vctrs \>=0.4.1 are now required.

- Bumped required R version to `>= 3.4.0` to reflect tidyverse
  standards.

## hardhat 0.2.0

CRAN release: 2022-01-24

- Moved [`tune()`](https://hardhat.tidymodels.org/dev/reference/tune.md)
  from tune to hardhat
  ([\#181](https://github.com/tidymodels/hardhat/issues/181)).

- Added
  [`extract_parameter_dials()`](https://hardhat.tidymodels.org/dev/reference/hardhat-extract.md)
  and
  [`extract_parameter_set_dials()`](https://hardhat.tidymodels.org/dev/reference/hardhat-extract.md)
  generics to extend the family of `extract_*()` generics.

- [`mold()`](https://hardhat.tidymodels.org/dev/reference/mold.md) no
  longer misinterprets `::` as an interaction term
  ([\#174](https://github.com/tidymodels/hardhat/issues/174)).

- When `indicators = "none"`,
  [`mold()`](https://hardhat.tidymodels.org/dev/reference/mold.md) no
  longer misinterprets factor columns as being part of an inline
  function if there is a similarly named non-factor column also present
  ([\#182](https://github.com/tidymodels/hardhat/issues/182)).

## hardhat 0.1.6

CRAN release: 2021-07-14

- Added a new family of `extract_*()` S3 generics for extracting
  important components from various tidymodels objects. S3 methods will
  be defined in other tidymodels packages. For example, tune will
  register an
  [`extract_workflow()`](https://hardhat.tidymodels.org/dev/reference/hardhat-extract.md)
  method to easily extract the workflow embedded within the result of
  `tune::last_fit()`.

- A logical `indicators` argument is no longer allowed in
  [`default_formula_blueprint()`](https://hardhat.tidymodels.org/dev/reference/default_formula_blueprint.md).
  This was soft-deprecated in hardhat 0.1.4, but will now result in an
  error ([\#144](https://github.com/tidymodels/hardhat/issues/144)).

## hardhat 0.1.5

CRAN release: 2020-11-09

- [`use_modeling_files()`](https://hardhat.tidymodels.org/dev/reference/modeling-usethis.md)
  (and therefore,
  [`create_modeling_package()`](https://hardhat.tidymodels.org/dev/reference/modeling-usethis.md))
  now ensures that all generated functions are templated on the model
  name. This makes it easier to add multiple models to the same package
  ([\#152](https://github.com/tidymodels/hardhat/issues/152)).

- All preprocessors can now
  [`mold()`](https://hardhat.tidymodels.org/dev/reference/mold.md) and
  [`forge()`](https://hardhat.tidymodels.org/dev/reference/forge.md)
  predictors to one of three output formats (either tibble, matrix, or
  `dgCMatrix` sparse matrix) via the `composition` argument of a
  blueprint ([\#100](https://github.com/tidymodels/hardhat/issues/100),
  [\#150](https://github.com/tidymodels/hardhat/issues/150)).

## hardhat 0.1.4

CRAN release: 2020-07-02

- Setting `indicators = "none"` in
  [`default_formula_blueprint()`](https://hardhat.tidymodels.org/dev/reference/default_formula_blueprint.md)
  no longer accidentally expands character columns into dummy variable
  columns. They are now left completely untouched and pass through as
  characters. When `indicators = "traditional"` or
  `indicators = "one_hot"`, character columns are treated as unordered
  factors ([\#139](https://github.com/tidymodels/hardhat/issues/139)).

- The `indicators` argument of
  [`default_formula_blueprint()`](https://hardhat.tidymodels.org/dev/reference/default_formula_blueprint.md)
  now takes character input rather than logical. To update:

      indicators = TRUE  -> indicators = "traditional"

      indicators = FALSE -> indicators = "none"

  Logical input for `indicators` will continue to work, with a warning,
  until hardhat 0.1.6, where it will be formally deprecated.

  There is also a new `indicators = "one_hot"` option which expands all
  factor columns into `K` dummy variable columns corresponding to the
  `K` levels of that factor, rather than the more traditional `K - 1`
  expansion.

## hardhat 0.1.3

CRAN release: 2020-05-20

- Updated to stay current with the latest vctrs 0.3.0 conventions.

- [`scream()`](https://hardhat.tidymodels.org/dev/reference/scream.md)
  is now stricter when checking ordered factor levels in new data
  against the `ptype` used at training time. Ordered factors must now
  have *exactly* the same set of levels at training and prediction time.
  See
  [`?scream`](https://hardhat.tidymodels.org/dev/reference/scream.md)
  for a new graphic outlining how factor levels are handled
  ([\#132](https://github.com/tidymodels/hardhat/issues/132)).

- The novel factor level check in
  [`scream()`](https://hardhat.tidymodels.org/dev/reference/scream.md)
  no longer throws a novel level warning on `NA` values
  ([\#131](https://github.com/tidymodels/hardhat/issues/131)).

## hardhat 0.1.2

CRAN release: 2020-02-28

- [`default_recipe_blueprint()`](https://hardhat.tidymodels.org/dev/reference/default_recipe_blueprint.md)
  now defaults to prepping recipes with `fresh = TRUE`. This is a safer
  default, and guards the user against accidentally skipping this
  preprocessing step when tuning
  ([\#122](https://github.com/tidymodels/hardhat/issues/122)).

- [`model_matrix()`](https://hardhat.tidymodels.org/dev/reference/model_matrix.md)
  now correctly strips all attributes from the result of the internal
  call to [`model.matrix()`](https://rdrr.io/r/stats/model.matrix.html).

## hardhat 0.1.1

CRAN release: 2020-01-08

- [`forge()`](https://hardhat.tidymodels.org/dev/reference/forge.md) now
  works correctly when used with a recipe that has a predictor with
  multiple roles
  ([\#120](https://github.com/tidymodels/hardhat/issues/120)).

- Require recipes 0.1.8 to incorporate an important bug fix with
  [`juice()`](https://recipes.tidymodels.org/reference/juice.html) and
  0-column selections.

## hardhat 0.1.0

CRAN release: 2019-12-16

- Added a `NEWS.md` file to track changes to the package.
